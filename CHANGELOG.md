# 変更履歴 / Changelog

このファイルはプロジェクトの主要な変更を記録します。

## [Unreleased] - 今後実装予定

### 予定している機能
1. **PlantUML形式のエクスポート** - ER図をPlantUML形式でダウンロード
2. **リレーション表記の改善** - 1対多、多対多などのカーディナリティ表示
3. **Mermaid形式の独立エクスポート** - Mermaid ER図の単独ダウンロード
4. **MDエクスポート形式の簡素化** - テーブル一覧とSQL定義のみに限定
5. **テーブルスキーマ表の生成** - 日本語説明付きのドキュメント生成機能

---

## [2025-10-19] - 線の形式変更、ミニマップ追加、モジュール化

### 追加
- **線の形式変更機能**: 実線/破線/点線/一点鎖線など5種類から選択可能
- **ミニマップ**: ReactFlowのミニマップコンポーネントを追加（ズーム・パン可能）
- **モジュール化**:
  - `constants/diagram.ts`: 定数とエラーメッセージの一元管理
  - `hooks/useFileUpload.ts`: ファイルアップロード処理のカスタムフック
  - `hooks/useDiagramExport.ts`: エクスポート処理のカスタムフック
  - `components/Header.tsx`: ヘッダーコンポーネント
  - `components/EmptyState.tsx`: 空状態表示コンポーネント

### 変更
- App.tsxを189行から73行に削減（約61%削減）
- コードの保守性と再利用性を向上

---

## [2025-10-19] - カラムレベルコネクタと線の編集機能

### 追加
- **カラムレベルのコネクタ**: 各テーブルのすべてのカラムに接続点を追加
- **ハンドルの色分け**:
  - 主キー+外部キー: 緑色
  - 主キーのみ: 金色
  - 外部キーのみ: 紫色
  - 通常のカラム: グレー
- **EdgeEditPanel**: 線の編集用パネルを新規作成
  - 色、太さ、形式（直線/階段/ベジェなど）の変更
  - アニメーション ON/OFF
  - ラベル編集
  - 矢印反転
  - 線の削除

### 修正
- **複合主キー・複合外部キーのサポート**: `PRIMARY KEY (col1, col2)` 形式に対応
- 正規表現を改善してカンマ区切りの複数カラムを検出

---

## [2025-10-19] - 初期機能とバグ修正

### 追加
- **機能1: 複数SQLファイルの読み込み**: 同じファイルを複数回開けるように改善
- **機能6: 外部キー表示の修正**: 紫色の鍵アイコンが正しく表示されるように修正

### 修正
- **App.tsx**: ファイル読み込み後にinput要素をリセット
- **ERDiagram.tsx**: initialNodes/initialEdgesが変更されたら完全に再構築
- **sqlParser.ts**: 外部キーフラグを後処理で更新するロジック追加

---

## [2025-10-19] - プロジェクト開始

### 追加
- 初期プロジェクトセットアップ
- SQL CREATE TABLE文からER図を自動生成
- ReactFlow を使用したインタラクティブなダイアグラム
- PNG/SVG/PDF/Markdown形式でのエクスポート機能
- スタイルカスタマイズパネル

---

## 今後の改善案 / Ideas for Future Improvements

### ユーザーからのフィードバック

#### 優先度: 高
1. **PlantUML形式のエクスポート** - 既存のドキュメントとの統合のため
2. **リレーション表記の改善** - ER図の可読性向上
3. **テーブルスキーマ表** - ドキュメント作成の効率化

#### 優先度: 中
4. **Mermaid形式の独立エクスポート** - Markdown内での利用
5. **MDエクスポート形式の改善** - 必要な情報のみに絞る

#### 検討中
- カラムのコメント機能（日本語説明の追加）
- テーブル間の依存関係の可視化
- SQLインポート時のバリデーション強化
- undo/redo 機能
- ダークモード対応

---

## 技術的な改善履歴

### パフォーマンス
- App.tsxのコード量を61%削減（v2025-10-19）

### コード品質
- TypeScript型エラーをすべて解決
- ESLintの未使用変数警告を解消
- カスタムフックによるロジック分離

### アーキテクチャ
- モジュール化により関心の分離を実現
- 定数の一元管理で保守性向上
- コンポーネントの責務を明確化
